# ============================================================================
# Intent-Driven Retrieval & Workflow Decision System
# 环境变量配置示例文件
# ============================================================================
# 
# 使用说明：
# 1. 复制此文件为 .env: cp .env.example .env
# 2. 根据实际情况修改配置值
# 3. 不要将 .env 文件提交到版本控制（已在 .gitignore 中）
#
# ============================================================================

# ----------------------------------------------------------------------------
# 数据库配置（必需）
# ----------------------------------------------------------------------------

# PostgreSQL 数据库连接字符串
# 格式: postgresql://用户名:密码@主机:端口/数据库名
# 
# 示例：
# - 本地数据库: postgresql://postgres:password@localhost:5432/intent_system
# - 远程数据库: postgresql://user:pass@192.168.1.100:5432/intent_system
# - 使用 SSL: postgresql://user:pass@host:5432/db?sslmode=require
#
# 注意：如果密码包含特殊字符，需要进行 URL 编码
# 例如密码 "p@ss#word" 需要编码为 "p%40ss%23word"
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/intent_system

# 是否输出 SQL 日志（用于调试）
# 开发环境建议: true
# 生产环境建议: false
DB_ECHO=false

# ----------------------------------------------------------------------------
# OpenAI API 配置（必需）
# ----------------------------------------------------------------------------

# OpenAI API 密钥
# 获取方式：
# 1. 访问 https://platform.openai.com/
# 2. 登录账户
# 3. 进入 API Keys 页面
# 4. 创建新的 API Key
#
# 注意：
# - API Key 以 sk- 开头
# - 只显示一次，请妥善保存
# - 不要提交到版本控制
# - 建议设置使用限额
OPENAI_API_KEY=sk-your-openai-api-key-here

# OpenAI API Base URL（可选，用于 Azure OpenAI 或其他兼容服务）
# 默认: https://api.openai.com/v1
# Azure OpenAI 示例: https://your-resource.openai.azure.com/
# OPENAI_API_BASE=https://api.openai.com/v1

# OpenAI Organization ID（可选）
# 如果使用组织账户，可以指定组织 ID
# OPENAI_ORG_ID=org-xxxxxxxxxxxxx

# ----------------------------------------------------------------------------
# 向量存储配置（可选）
# ----------------------------------------------------------------------------

# 向量存储路径
# 用于存储文档嵌入向量的本地路径
# 
# 路径类型：
# - 相对路径: ./data/chroma（相对于项目根目录）
# - 绝对路径: /var/lib/intent-system/chroma（Linux/Mac）
# - Windows 路径: C:\data\intent-system\chroma
#
# 注意：
# - 目录不存在时会自动创建
# - 确保目录有读写权限
# - 生产环境建议使用持久化存储
VECTOR_STORE_PATH=./data/chroma

# ----------------------------------------------------------------------------
# 服务配置（可选）
# ----------------------------------------------------------------------------

# 服务监听地址
# 默认: 0.0.0.0（监听所有网络接口）
# 仅本地: 127.0.0.1
HOST=0.0.0.0

# 服务监听端口
# 默认: 8000
# 如果端口被占用，可以修改为其他端口（如 8001, 8080）
PORT=8000

# 是否启用自动重载（开发环境）
# true: 代码修改后自动重启（开发环境推荐）
# false: 不自动重启（生产环境必须）
RELOAD=false

# ----------------------------------------------------------------------------
# Jaeger 分布式追踪配置（可选）
# ----------------------------------------------------------------------------

# 是否启用 Jaeger 分布式追踪
# true: 启用追踪（生产环境推荐）
# false: 禁用追踪（开发环境可以关闭）
JAEGER_ENABLED=false

# Jaeger Agent 主机地址
# 默认: localhost
# 如果 Jaeger 运行在其他机器，修改为对应 IP 或域名
JAEGER_HOST=localhost

# Jaeger Agent 端口
# 默认: 6831（UDP）
# 如果使用不同的端口，修改此处
JAEGER_PORT=6831

# Jaeger Service Name
# 在 Jaeger UI 中显示的服务名称
# 默认: intent-system
JAEGER_SERVICE_NAME=intent-system

# ----------------------------------------------------------------------------
# 日志配置（可选）
# ----------------------------------------------------------------------------

# 日志级别
# 可选值: DEBUG, INFO, WARNING, ERROR, CRITICAL
# 开发环境建议: DEBUG 或 INFO
# 生产环境建议: INFO 或 WARNING
LOG_LEVEL=INFO

# 日志文件路径（可选）
# 如果设置，日志会同时输出到文件和控制台
# 如果不设置，只输出到控制台
# LOG_FILE=./logs/app.log

# 日志文件最大大小（MB）
# 当日志文件超过此大小时，会进行轮转
# LOG_MAX_SIZE=100

# 保留的日志文件数量
# 超过此数量的旧日志文件会被删除
# LOG_BACKUP_COUNT=10

# ----------------------------------------------------------------------------
# 安全配置（可选，生产环境建议配置）
# ----------------------------------------------------------------------------

# API 密钥（用于 API 认证）
# 如果设置，所有 API 请求需要在 Header 中提供此密钥
# Header 名称: X-API-Key
# 
# 生产环境强烈建议设置此值
# API_KEY=your-secret-api-key-here

# CORS 允许的来源（多个用逗号分隔）
# 示例: https://example.com,https://app.example.com
# 开发环境可以使用: *
# 生产环境必须指定具体域名
CORS_ORIGINS=*

# ----------------------------------------------------------------------------
# 性能配置（可选）
# ----------------------------------------------------------------------------

# 数据库连接池大小
# 建议值: CPU核心数 * 2
# 默认: 10
# DB_POOL_SIZE=10

# 数据库最大溢出连接数
# 当连接池满时，允许的额外连接数
# 默认: 20
# DB_MAX_OVERFLOW=20

# 数据库连接回收时间（秒）
# 连接使用超过此时间后会被回收，防止连接过期
# 默认: 3600（1小时）
# DB_POOL_RECYCLE=3600

# HTTP 请求超时时间（秒）
# 默认: 30
# HTTP_TIMEOUT=30

# LLM 请求超时时间（秒）
# OpenAI API 调用超时时间
# 默认: 60
# LLM_TIMEOUT=60

# ----------------------------------------------------------------------------
# 缓存配置（可选）
# ----------------------------------------------------------------------------

# Redis 主机地址（如果使用 Redis 缓存）
# REDIS_HOST=localhost

# Redis 端口
# REDIS_PORT=6379

# Redis 密码（如果有）
# REDIS_PASSWORD=

# Redis 数据库编号（0-15）
# REDIS_DB=0

# 缓存过期时间（秒）
# 默认: 3600（1小时）
# CACHE_TTL=3600

# ----------------------------------------------------------------------------
# 功能开关（可选）
# ----------------------------------------------------------------------------

# 是否启用文档自动索引
# true: 注册文档资源时自动索引
# false: 需要手动调用 reindex API
AUTO_INDEX_DOCS=true

# 是否启用结果缓存
# true: 缓存执行结果
# false: 不缓存
ENABLE_RESULT_CACHE=true

# 是否启用请求限流
# true: 启用限流保护
# false: 不限制
ENABLE_RATE_LIMIT=false

# 每分钟最大请求数（如果启用限流）
# RATE_LIMIT_PER_MINUTE=60

# ----------------------------------------------------------------------------
# 监控和告警（可选）
# ----------------------------------------------------------------------------

# 是否启用健康检查端点
# 默认: true
# ENABLE_HEALTH_CHECK=true

# 是否启用指标端点（Prometheus 格式）
# 默认: false
# ENABLE_METRICS=false

# 告警邮箱（用于发送告警通知）
# ALERT_EMAIL=admin@example.com

# ----------------------------------------------------------------------------
# 开发环境特定配置（可选）
# ----------------------------------------------------------------------------

# 是否启用调试模式
# 开发环境: true
# 生产环境: false
DEBUG=false

# 是否显示详细错误信息
# 开发环境: true（显示完整堆栈）
# 生产环境: false（只显示错误消息）
SHOW_DETAILED_ERRORS=false

# 是否启用 API 文档
# true: 可以通过 /docs 访问 Swagger UI
# false: 禁用 API 文档（生产环境建议）
ENABLE_API_DOCS=true

# ----------------------------------------------------------------------------
# 测试环境配置（可选）
# ----------------------------------------------------------------------------

# 测试数据库 URL（用于运行测试）
# TEST_DATABASE_URL=postgresql://postgres:postgres@localhost:5432/intent_system_test

# 是否在测试中使用真实 OpenAI API
# false: 使用 Mock（推荐，节省成本）
# true: 使用真实 API（用于集成测试）
USE_REAL_OPENAI_IN_TEST=false

# ----------------------------------------------------------------------------
# 其他配置（可选）
# ----------------------------------------------------------------------------

# 时区设置
# 默认: UTC
# 中国: Asia/Shanghai
TIMEZONE=UTC

# 语言设置
# 默认: zh_CN
# 可选: en_US, zh_CN
LANGUAGE=zh_CN

# 最大上传文件大小（MB）
# 默认: 10
MAX_UPLOAD_SIZE=10

# 工作流执行超时时间（秒）
# 默认: 300（5分钟）
WORKFLOW_TIMEOUT=300

# 文档分块大小（字符数）
# 默认: 500
DOC_CHUNK_SIZE=500

# 文档分块重叠大小（字符数）
# 默认: 50
DOC_CHUNK_OVERLAP=50

# ============================================================================
# 配置完成提示
# ============================================================================
# 
# 配置完成后，请：
# 1. 检查所有必需配置项是否已填写
# 2. 验证数据库连接: psql $DATABASE_URL -c "SELECT 1;"
# 3. 验证 OpenAI API: curl https://api.openai.com/v1/models -H "Authorization: Bearer $OPENAI_API_KEY"
# 4. 启动服务: python run.py
#
# ============================================================================